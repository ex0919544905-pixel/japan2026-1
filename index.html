<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#3F5B3B" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Trip Planner" />
    <title>åœ˜é«”æ—…éŠè¦åŠƒ PWA</title>

    <!-- Tailwind (CDN for prototype) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            boxShadow: {
              soft: "0 10px 25px rgba(0,0,0,.08)",
              soft2: "0 6px 18px rgba(0,0,0,.10)",
            },
            borderRadius: {
              xl2: "1.25rem",
            },
            colors: {
              sand: {
                50: "#FAF7F0",
                100: "#F3ECDD",
                200: "#E9DEC4",
                300: "#DCC9A2",
                400: "#CDB07F",
                500: "#B28E58",
                600: "#8F6F3F",
                700: "#6E5631",
                800: "#4B3B22",
                900: "#2A2115",
              },
              moss: {
                50: "#F3F7F2",
                100: "#E2EBDD",
                200: "#C1D3B8",
                300: "#9BB58C",
                400: "#76966A",
                500: "#5C7F52",
                600: "#46623F",
                700: "#364B30",
                800: "#263421",
                900: "#162012",
              },
              clay: {
                50: "#FBF6F2",
                100: "#F4E7DF",
                200: "#EBCFBE",
                300: "#DBB19B",
                400: "#C98E72",
                500: "#B56E4E",
                600: "#8E563C",
                700: "#6D4230",
                800: "#4C2E22",
                900: "#2C1B14",
              },
            },
          },
        },
      };
    </script>

    <!-- React (CDN) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      /* iOS safe-area padding helpers */
      .safe-b { padding-bottom: max(16px, env(safe-area-inset-bottom)); }
      .safe-t { padding-top: max(16px, env(safe-area-inset-top)); }
      /* subtle grain */
      .grain::before{
        content:"";
        position:absolute; inset:0;
        background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency=".8" numOctaves="2" stitchTiles="stitch"/></filter><rect width="120" height="120" filter="url(%23n)" opacity=".06"/></svg>');
        pointer-events:none;
        mix-blend-mode:multiply;
      }
      .no-scrollbar::-webkit-scrollbar{ display:none; }
      .no-scrollbar{ -ms-overflow-style:none; scrollbar-width:none; }
    </style>
  </head>

  <body class="bg-sand-50 text-sand-900">
    <div id="root"></div>

    <script type="text/babel">
      const { useEffect, useMemo, useRef, useState } = React;

      // ---------- Helpers ----------
      const cx = (...args) => args.filter(Boolean).join(" ");
      const fmtMoney = (n) => new Intl.NumberFormat("zh-TW").format(Math.round(n));
      const pad2 = (n) => String(n).padStart(2, "0");

      // Category visual system
      const CATEGORY = {
        sight: { label: "æ™¯é»", pill: "bg-moss-100 text-moss-800 ring-1 ring-moss-200", dot: "bg-moss-500" },
        food:  { label: "ç¾é£Ÿ", pill: "bg-clay-100 text-clay-800 ring-1 ring-clay-200", dot: "bg-clay-500" },
        move:  { label: "äº¤é€š", pill: "bg-sand-100 text-sand-800 ring-1 ring-sand-200", dot: "bg-sand-500" },
        stay:  { label: "ä½å®¿", pill: "bg-slate-100 text-slate-700 ring-1 ring-slate-200", dot: "bg-slate-500" },
      };

      const WEATHER = {
        "2026-01-01": { icon: "â˜ï¸", label: "å¤šé›²", hi: 7, lo: 2, rain: 15 },
        "2026-01-02": { icon: "ğŸŒ¤ï¸", label: "æ™´æ™‚å¤šé›²", hi: 6, lo: 1, rain: 10 },
        "2026-01-03": { icon: "ğŸŒ§ï¸", label: "å°é›¨", hi: 5, lo: 2, rain: 55 },
        "2026-01-04": { icon: "â›…ï¸", label: "é™°çŸ­æš«æ™´", hi: 7, lo: 2, rain: 25 },
        "2026-01-05": { icon: "ğŸŒ¤ï¸", label: "æ™´", hi: 10, lo: 4, rain: 5 },
      };

      // ---------- Data (based on your text) ----------
      const TRIP_DAYS = [
        { key: "2026-01-01", label: "1/1ï¼ˆå››ï¼‰" },
        { key: "2026-01-02", label: "1/2ï¼ˆäº”ï¼‰" },
        { key: "2026-01-03", label: "1/3ï¼ˆå…­ï¼‰" },
        { key: "2026-01-04", label: "1/4ï¼ˆæ—¥ï¼‰" },
        { key: "2026-01-05", label: "1/5ï¼ˆä¸€ï¼‰" },
      ];

      const SCHEDULE = {
        "2026-01-01": [
          {
            id: "d1-1",
            time: "04:30",
            title: "å‡Œæ™¨åˆ°æ©Ÿå ´å ±åˆ°ï¼ˆé ä¼° 4â€“5 é»ï¼‰",
            category: "move",
            place: "æ¡ƒåœ’åœ‹éš›æ©Ÿå ´ T2",
            note: "ææ—©åˆ°ã€æ›æ—¥å¹£/äº¤é€šç¥¨åˆ¸å¯ä¸€èµ·è™•ç†ã€‚",
            map: "https://www.google.com/maps/search/?api=1&query=æ¡ƒåœ’åœ‹éš›æ©Ÿå ´ç¬¬äºŒèˆªå»ˆ",
          },
          {
            id: "d1-2",
            time: "06:35â€“10:25",
            title: "âœˆï¸ é•·æ¦® BR158 æ¡ƒåœ’äºŒèˆª â†’ å°æ¾æ©Ÿå ´",
            category: "move",
            place: "TPE â†’ KMQ",
            note: "æ©Ÿä¸Šä¼‘æ¯è£œçœ ã€‚è½åœ°å¾Œæ‰¾å·´å£«å”®ç¥¨æ©Ÿã€‚",
            map: "https://www.google.com/maps/search/?api=1&query=Komatsu%20Airport",
          },
          {
            id: "d1-3",
            time: "10:40",
            title: "æ­åˆ©æœ¨æ´¥å·´å£« â†’ é‡‘æ¾¤ç«™è¥¿å£ï¼ˆç´„ 40 åˆ†ï¼‰",
            category: "move",
            place: "å°æ¾æ©Ÿå ´ â†’ é‡‘æ¾¤ç«™ï¼ˆè¥¿å£ï¼‰",
            note: "å…ˆæ‰¾è‡ªå‹•è²©è³£æ©Ÿå–è»Šç¥¨ã€‚",
            map: "https://www.google.com/maps/search/?api=1&query=é‡‘æ¾¤ç«™è¥¿å£",
          },
          {
            id: "d1-4",
            time: "12:00",
            title: "æ­¥è¡Œ 5 åˆ†é˜ â†’ é‡‘æ¾¤ FORUS å¯„è¡Œæ & é€›è¡—",
            category: "sight",
            place: "Kanazawa FORUS / é‡‘æ¾¤è»Šç«™",
            note: "ä¸­åˆï½ä¸‹åˆä»¥è»Šç«™å‘¨é‚Šç‚ºä¸»ï¼Œè£œç‰©è³‡ã€‚",
            map: "https://www.google.com/maps/search/?api=1&query=Kanazawa%20Forus",
          },
          {
            id: "d1-5",
            time: "18:30",
            title: "ç‰‡ç”ºå‘¨é‚Šï¼šé—œæ±ç…® + æ™ƒæ™ƒ",
            category: "food",
            place: "ç‰‡ç”º Katamachi",
            note: "æ™šé¤å¾Œæ•£æ­¥æ¶ˆåŒ–ï¼Œæ—©é»ä¼‘æ¯ã€‚",
            map: "https://www.google.com/maps/search/?api=1&query=ç‰‡ç”º%20é‡‘æ¾¤",
          },
        ],
        "2026-01-02": [
          { id: "d2-1", time: "06:00", title: "èµ·åºŠæ¢³æ´—ã€ä¾¿åˆ©å•†åº—è£œçµ¦", category: "food", place: "é‡‘æ¾¤", note: "å‡ºç™¼å‰è²·æ°´/æ—©é¤ã€‚", map: "https://www.google.com/maps/search/?api=1&query=é‡‘æ¾¤%20ä¾¿åˆ©å•†åº—" },
          { id: "d2-2", time: "06:51â€“07:14", title: "ğŸš„ æ–°å¹¹ç·š åŠ Tsurugi 60ï¼šé‡‘æ¾¤ â†’ å¯Œå±±", category: "move", place: "é‡‘æ¾¤ç«™ â†’ å¯Œå±±ç«™", note: "æº–æ™‚é€²ç«™ï¼Œç•™æ„æœˆå°ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Toyama%20Station" },
          { id: "d2-3", time: "07:58â€“09:28", title: "ğŸš„ ç‰¹æ€¥ é£›é©’ Hida 6ï¼ˆæŒ‡å®šå¸­ï¼‰ï¼šå¯Œå±± â†’ é«˜å±±", category: "move", place: "å¯Œå±±ç«™ â†’ é«˜å±±ç«™", note: "è»Šä¸Šå¯è£œçœ /çœ‹è¡Œç¨‹ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Takayama%20Station" },
          { id: "d2-4", time: "10:00", title: "Starbucks é«˜å±±å²¡æœ¬åº—", category: "food", place: "é«˜å±±", note: "æ‹ç…§é»ï¼Œæš–èº«ã€‚", map: "https://www.google.com/maps/search/?api=1&query=ã‚¹ã‚¿ãƒ¼ãƒãƒƒã‚¯ã‚¹%20é«˜å±±å²¡æœ¬åº—" },
          { id: "d2-5", time: "10:40", title: "èˆ©å‚é…’é€ åº—", category: "sight", place: "é«˜å±±", note: "å°é…Œè©¦é£²æ³¨æ„æ­¥ä¼ã€‚", map: "https://www.google.com/maps/search/?api=1&query=èˆ©å‚é…’é€ åº—" },
          { id: "d2-6", time: "11:10", title: "miffy ãŠã‚„ã¤å ‚ï¼ˆé£›é©’é«˜å±±åº—ï¼‰", category: "food", place: "é«˜å±±", note: "ç”œé»è£œèƒ½é‡ã€‚", map: "https://www.google.com/maps/search/?api=1&query=miffy%20ãŠã‚„ã¤å ‚%20é£›é¨¨é«˜å±±åº—" },
          { id: "d2-7", time: "11:40", title: "é«˜å±±å¸ƒä¸äº­ / Pen Shop IMAI / æ©‹æœ¬ç…é¤…å ‚", category: "sight", place: "é«˜å±±è€è¡—", note: "æ²¿è·¯é€›ï¼Œå½ˆæ€§åƒåˆé¤ã€‚", map: "https://www.google.com/maps/search/?api=1&query=é«˜å±±%20å¤ã„ç”ºä¸¦" },
          { id: "d2-8", time: "15:17â€“16:44", title: "ğŸš„ ç‰¹æ€¥ é£›é©’ Hida 11ï¼šé«˜å±± â†’ å¯Œå±±", category: "move", place: "é«˜å±±ç«™ â†’ å¯Œå±±ç«™", note: "å›ç¨‹è£œçœ ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Toyama%20Station" },
          { id: "d2-9", time: "17:10", title: "ğŸš„ æ–°å¹¹ç·šï¼ˆè‡ªç”±å¸­ï¼‰ï¼šå¯Œå±± â†’ é‡‘æ¾¤", category: "move", place: "å¯Œå±± â†’ é‡‘æ¾¤", note: "ç¾å ´è²·ç¥¨ï¼›äººå¤šæ™‚ææ—©æ’éšŠã€‚", map: "https://www.google.com/maps/search/?api=1&query=é‡‘æ¾¤ç«™" },
          { id: "d2-10", time: "19:00", title: "æ™šé¤ & ä¼‘æ¯", category: "food", place: "é‡‘æ¾¤", note: "å›é£¯åº—å¾Œæ•´ç†æˆ°åˆ©å“ã€‚", map: "https://www.google.com/maps/search/?api=1&query=é‡‘æ¾¤%20é¤å»³" },
        ],
        "2026-01-03": [
          { id: "d3-1", time: "09:00â€“10:00", title: "æ—©é¤ï¼šæ±å‡ºçˆç²åº—", category: "food", place: "é‡‘æ¾¤", note: "å»ºè­°ææ—©åˆ°é¿å…æ’éšŠã€‚", map: "https://www.google.com/maps/search/?api=1&query=æ±å‡ºçˆç²åº—" },
          { id: "d3-2", time: "10:30", title: "é‡‘æ¾¤ â†’ å¯Œå±±ï¼ˆç§»å‹•ï¼‰", category: "move", place: "é‡‘æ¾¤ â†’ å¯Œå±±", note: "åˆå‰ï½ä¸­åˆç§»å‹•ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Toyama%20Station" },
          { id: "d3-3", time: "13:00", title: "å¯Œå±±å¸‚å€æ´»å‹•ï¼ˆå½ˆæ€§å®‰æ’ï¼‰", category: "sight", place: "å¯Œå±±å¸‚å€", note: "ä¾å¤©æ°£/é«”åŠ›å¾®èª¿ã€‚", map: "https://www.google.com/maps/search/?api=1&query=å¯Œå±±å¸‚" },
          { id: "d3-4", time: "19:00", title: "æ™šé¤ & ä¼‘æ¯", category: "food", place: "å¯Œå±±/é‡‘æ¾¤ï¼ˆä¾ä½å®¿ï¼‰", note: "æ—©ç¡ï¼Œéš”å¤©è¡Œç¨‹è¼ƒæ»¿ã€‚", map: "https://www.google.com/maps/search/?api=1&query=å¯Œå±±%20é¤å»³" },
        ],
        "2026-01-04": [
          { id: "d4-1", time: "10:00", title: "é‡‘æ¾¤ 21 ä¸–ç´€ç¾è¡“é¤¨", category: "sight", place: "é‡‘æ¾¤", note: "ç†±é–€å±•å€å¯å…ˆæŸ¥ç¥¨å‹™/é–‹é¤¨ã€‚", map: "https://www.google.com/maps/search/?api=1&query=21st%20Century%20Museum%20of%20Contemporary%20Art%20Kanazawa" },
          { id: "d4-2", time: "12:00", title: "Le MusÃ©e de H", category: "food", place: "é‡‘æ¾¤", note: "ç”œé»/å’–å•¡ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Le%20Mus%C3%A9e%20de%20H%20Kanazawa" },
          { id: "d4-3", time: "13:30", title: "æ±èŒ¶å±‹è¡—ï¼ˆæ•£æ­¥é€›è¡—ï¼‰", category: "sight", place: "é‡‘æ¾¤", note: "æ‹ç…§è·¯ç·šé †èµ°ã€‚", map: "https://www.google.com/maps/search/?api=1&query=æ±èŒ¶å±‹è¡—%20é‡‘æ¾¤" },
          { id: "d4-4", time: "15:30", title: "å…¼å…­åœ’ & é‡‘æ¾¤åŸ", category: "sight", place: "é‡‘æ¾¤", note: "é»ƒæ˜æ™‚æ®µå…‰ç·šæ¼‚äº®ã€‚", map: "https://www.google.com/maps/search/?api=1&query=å…¼å…­åœ’" },
          { id: "d4-5", time: "17:30", title: "Kajimart è¶…å¸‚æ¡è³¼ â†’ å›é£¯åº—æ”¾æ±è¥¿", category: "move", place: "é‡‘æ¾¤", note: "è£œé›¶é£Ÿ/é£²æ–™/éš”å¤©è·¯ä¸Šé£Ÿç‰©ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Kajimart%20é‡‘æ¾¤" },
          { id: "d4-6", time: "19:30", title: "ç¥ç¤¾åƒæ‹œ & ç‰‡ç”ºå‘¨é‚Šæ™ƒ", category: "sight", place: "é‡‘æ¾¤", note: "æ”¾é¬†æ”¶å°¾ã€‚", map: "https://www.google.com/maps/search/?api=1&query=é‡‘æ¾¤%20ç¥ç¤¾" },
        ],
        "2026-01-05": [
          { id: "d5-1", time: "08:00", title: "æ¸…æ™¨æ•´ç†è¡Œæã€æº–å‚™å‡ºé–€", category: "stay", place: "é‡‘æ¾¤", note: "é€€æˆ¿ã€æª¢æŸ¥å……é›»å™¨/è­·ç…§ã€‚", map: "" },
          { id: "d5-2", time: "09:30", title: "é‡‘æ¾¤ â†’ å°æ¾æ©Ÿå ´ï¼ˆå·´å£«ï¼‰", category: "move", place: "é‡‘æ¾¤ç«™ â†’ å°æ¾æ©Ÿå ´", note: "é ç•™å€™è»Šèˆ‡æ’éšŠæ™‚é–“ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Komatsu%20Airport" },
          { id: "d5-3", time: "11:45â€“14:35", title: "âœˆï¸ é•·æ¦® BR157 å°æ¾ â†’ æ¡ƒåœ’äºŒèˆª", category: "move", place: "KMQ â†’ TPE", note: "å¹³å®‰å›å®¶ï½", map: "https://www.google.com/maps/search/?api=1&query=æ¡ƒåœ’åœ‹éš›æ©Ÿå ´ç¬¬äºŒèˆªå»ˆ" },
        ],
      };

      const INITIAL_BOOKINGS = {
        flight: {
          airline: "EVA Air é•·æ¦®èˆªç©º",
          flightNoGo: "BR158",
          flightNoBack: "BR157",
          from: "TPE æ¡ƒåœ’ T2",
          to: "KMQ å°æ¾",
          departGo: "2026-01-01 06:35",
          arriveGo: "2026-01-01 10:25",
          departBack: "2026-01-05 11:45",
          arriveBack: "2026-01-05 14:35",
          seat: "â€”",
          pnr: "â€”",
        },
        hotel: {
          name: "ï¼ˆè«‹å¡«ï¼‰é‡‘æ¾¤ä½å®¿",
          img:
            "https://images.unsplash.com/photo-1501117716987-c8e1ecb21000?auto=format&fit=crop&w=1200&q=70",
          checkin: "15:00",
          checkout: "11:00",
          address: "ï¼ˆè«‹å¡«ï¼‰",
          map: "https://www.google.com/maps/search/?api=1&query=Kanazawa%20hotel",
          note: "å¯åœ¨ä¹‹å¾Œæ¥ Firebase è®€å–çœŸå¯¦è¨‚å–®è³‡æ–™ã€‚",
        },
      };

      // ---------- UI Primitives ----------
      function TopBar({ title, subtitle }) {
        return (
          <div className="safe-t sticky top-0 z-30 bg-sand-50/85 backdrop-blur-md">
            <div className="mx-auto max-w-md px-4 pt-2 pb-3">
              <div className="flex items-end justify-between gap-3">
                <div>
                  <div className="text-[13px] text-sand-600">{subtitle}</div>
                  <div className="text-xl font-semibold tracking-tight">{title}</div>
                </div>
                <div className="flex items-center gap-2">
                  <div className="rounded-full bg-white shadow-soft px-3 py-1 text-[12px] text-sand-700 ring-1 ring-sand-100">
                    PWA Prototype
                  </div>
                </div>
              </div>
            </div>
            <div className="h-px bg-sand-100" />
          </div>
        );
      }

      function Card({ children, className }) {
        return (
          <div className={cx("rounded-xl2 bg-white shadow-soft ring-1 ring-sand-100", className)}>
            {children}
          </div>
        );
      }

      function Modal({ open, onClose, title, children }) {
        const ref = useRef(null);
        useEffect(() => {
          if (!open) return;
          const onKey = (e) => e.key === "Escape" && onClose();
          window.addEventListener("keydown", onKey);
          return () => window.removeEventListener("keydown", onKey);
        }, [open, onClose]);

        useEffect(() => {
          if (open) setTimeout(() => ref.current?.focus(), 0);
        }, [open]);

        if (!open) return null;

        return (
          <div className="fixed inset-0 z-50">
            <div className="absolute inset-0 bg-black/35" onClick={onClose} />
            <div className="absolute inset-x-0 bottom-0 mx-auto max-w-md px-3 pb-3 safe-b">
              <div
                className="grain relative rounded-2xl bg-sand-50 shadow-soft2 ring-1 ring-sand-200 outline-none"
                tabIndex={-1}
                ref={ref}
              >
                <div className="flex items-center justify-between px-4 pt-4">
                  <div className="text-base font-semibold">{title}</div>
                  <button
                    onClick={onClose}
                    className="rounded-full bg-white/80 px-3 py-1 text-sm ring-1 ring-sand-200 hover:bg-white"
                  >
                    é—œé–‰
                  </button>
                </div>
                <div className="px-4 pb-4 pt-3">{children}</div>
              </div>
            </div>
          </div>
        );
      }

      function TabBar({ tab, setTab }) {
        const items = [
          { key: "schedule", label: "è¡Œç¨‹", icon: "ğŸ—“ï¸" },
          { key: "bookings", label: "é è¨‚", icon: "ğŸ«" },
          { key: "expense", label: "è¨˜å¸³", icon: "ğŸ§¾" },
        ];
        return (
          <div className="safe-b fixed inset-x-0 bottom-0 z-40 bg-sand-50/90 backdrop-blur-md">
            <div className="mx-auto max-w-md px-4 pb-2 pt-2">
              <div className="grid grid-cols-3 gap-2 rounded-2xl bg-white shadow-soft ring-1 ring-sand-100 p-2">
                {items.map((it) => {
                  const active = tab === it.key;
                  return (
                    <button
                      key={it.key}
                      onClick={() => setTab(it.key)}
                      className={cx(
                        "rounded-2xl px-3 py-2 text-sm font-medium transition",
                        active
                          ? "bg-moss-600 text-white shadow-soft"
                          : "bg-sand-50 text-sand-800 hover:bg-sand-100"
                      )}
                    >
                      <div className="flex items-center justify-center gap-2">
                        <span className={cx("text-base", active ? "" : "opacity-90")}>{it.icon}</span>
                        <span>{it.label}</span>
                      </div>
                    </button>
                  );
                })}
              </div>
            </div>
          </div>
        );
      }

      // ---------- Schedule Tab ----------
      function WeatherCard({ dayKey }) {
        const w = WEATHER[dayKey] ?? { icon: "ğŸŒ¤ï¸", label: "æ™´", hi: 8, lo: 3, rain: 10 };
        return (
          <Card className="p-4">
            <div className="flex items-center justify-between">
              <div>
                <div className="text-sm text-sand-600">å¤©æ°£ï¼ˆå‡æƒ³ï¼‰</div>
                <div className="mt-1 flex items-baseline gap-2">
                  <div className="text-2xl">{w.icon}</div>
                  <div className="text-lg font-semibold">{w.label}</div>
                </div>
                <div className="mt-1 text-sm text-sand-700">
                  {w.lo}Â°C â€“ {w.hi}Â°C<span className="mx-2 text-sand-300">â€¢</span>é™é›¨ {w.rain}%
                </div>
              </div>

              <div className="text-right">
                <div className="text-xs text-sand-500">å»ºè­°</div>
                <div className="mt-1 text-sm font-medium text-sand-800">
                  {w.rain >= 50 ? "å¸¶å‚˜ / é˜²æ°´é‹" : w.hi <= 6 ? "ä¿æš–åˆ†å±¤" : "è¼•ä¾¿å¥½èµ°"}
                </div>
                <div className="mt-1 text-xs text-sand-500">ï¼ˆä¹‹å¾Œå¯æ¥çœŸå¯¦å¤©æ°£ APIï¼‰</div>
              </div>
            </div>
          </Card>
        );
      }

      function DateStrip({ selected, onSelect }) {
        return (
          <div className="no-scrollbar -mx-4 overflow-x-auto px-4">
            <div className="flex gap-2 py-2">
              {TRIP_DAYS.map((d) => {
                const active = d.key === selected;
                return (
                  <button
                    key={d.key}
                    onClick={() => onSelect(d.key)}
                    className={cx(
                      "shrink-0 rounded-2xl px-4 py-2 text-sm font-medium ring-1 transition",
                      active
                        ? "bg-moss-600 text-white ring-moss-600 shadow-soft"
                        : "bg-white text-sand-800 ring-sand-100 hover:bg-sand-50"
                    )}
                  >
                    {d.label}
                  </button>
                );
              })}
            </div>
          </div>
        );
      }

      function TimelineItem({ item, onClick }) {
        const meta = CATEGORY[item.category] ?? CATEGORY.sight;
        return (
          <button
            onClick={onClick}
            className="w-full text-left rounded-2xl bg-white ring-1 ring-sand-100 shadow-soft px-4 py-3 hover:bg-sand-50 transition"
          >
            <div className="flex items-start gap-3">
              <div className="mt-1 flex flex-col items-center">
                <div className={cx("h-3 w-3 rounded-full", meta.dot)} />
                <div className="mt-2 h-10 w-px bg-sand-100" />
              </div>

              <div className="min-w-0 flex-1">
                <div className="flex items-center justify-between gap-3">
                  <div className="text-sm font-semibold text-sand-900">{item.time}</div>
                  <span className={cx("shrink-0 rounded-full px-2 py-1 text-[12px] font-semibold", meta.pill)}>
                    {meta.label}
                  </span>
                </div>
                <div className="mt-1 text-[15px] font-semibold leading-snug">{item.title}</div>
                <div className="mt-1 text-sm text-sand-600 truncate">{item.place}</div>
              </div>

              <div className="mt-1 shrink-0 text-sand-400">â€º</div>
            </div>
          </button>
        );
      }

      function ScheduleTab() {
        const [dayKey, setDayKey] = useState(TRIP_DAYS[0].key);
        const [selectedItem, setSelectedItem] = useState(null);

        const items = SCHEDULE[dayKey] ?? [];

        return (
          <div className="mx-auto max-w-md px-4 pb-28 pt-4">
            <DateStrip selected={dayKey} onSelect={setDayKey} />
            <div className="mt-2">
              <WeatherCard dayKey={dayKey} />
            </div>

            <div className="mt-4 flex items-center justify-between">
              <div>
                <div className="text-sm text-sand-600">æ¯æ—¥æ™‚é–“è»¸</div>
                <div className="text-base font-semibold">{TRIP_DAYS.find((d) => d.key === dayKey)?.label}</div>
              </div>
              <div className="text-xs text-sand-500">{items.length} å€‹é …ç›®</div>
            </div>

            <div className="mt-3 space-y-3">
              {items.map((it) => (
                <TimelineItem key={it.id} item={it} onClick={() => setSelectedItem(it)} />
              ))}
            </div>

            <Modal
              open={!!selectedItem}
              onClose={() => setSelectedItem(null)}
              title="è¡Œç¨‹è©³æƒ…"
            >
              {selectedItem && (
                <div className="space-y-3">
                  <div className="flex items-start justify-between gap-3">
                    <div>
                      <div className="text-sm text-sand-600">{selectedItem.time}</div>
                      <div className="mt-1 text-lg font-semibold leading-snug">{selectedItem.title}</div>
                      <div className="mt-1 text-sm text-sand-700">{selectedItem.place}</div>
                    </div>
                    <span
                      className={cx(
                        "shrink-0 rounded-full px-3 py-1 text-[12px] font-semibold",
                        (CATEGORY[selectedItem.category] ?? CATEGORY.sight).pill
                      )}
                    >
                      {(CATEGORY[selectedItem.category] ?? CATEGORY.sight).label}
                    </span>
                  </div>

                  <Card className="p-3">
                    <div className="text-xs text-sand-500">å‚™è¨»</div>
                    <div className="mt-1 text-sm text-sand-800 leading-relaxed">
                      {selectedItem.note || "ï¼ˆå°šæœªå¡«å¯«ï¼‰"}
                    </div>
                  </Card>

                  <div className="flex gap-2">
                    <a
                      href={selectedItem.map || "#"}
                      target="_blank"
                      rel="noreferrer"
                      className={cx(
                        "flex-1 rounded-2xl px-4 py-3 text-center text-sm font-semibold shadow-soft ring-1 transition",
                        selectedItem.map
                          ? "bg-moss-600 text-white ring-moss-600 hover:bg-moss-700"
                          : "bg-sand-100 text-sand-400 ring-sand-200 pointer-events-none"
                      )}
                    >
                      æ‰“é–‹åœ°åœ–
                    </a>
                    <button
                      onClick={() => navigator.clipboard?.writeText(`${selectedItem.time} ${selectedItem.title} @ ${selectedItem.place}`)}
                      className="flex-1 rounded-2xl bg-white px-4 py-3 text-sm font-semibold shadow-soft ring-1 ring-sand-100 hover:bg-sand-50"
                    >
                      è¤‡è£½æ‘˜è¦
                    </button>
                  </div>
                </div>
              )}
            </Modal>
          </div>
        );
      }

      // ---------- Bookings Tab ----------
      function BoardingPass({ flight, direction }) {
        const isGo = direction === "go";
        const from = isGo ? flight.from : flight.to;
        const to = isGo ? flight.to : flight.from;
        const no = isGo ? flight.flightNoGo : flight.flightNoBack;
        const depart = isGo ? flight.departGo : flight.departBack;
        const arrive = isGo ? flight.arriveGo : flight.arriveBack;

        return (
          <div className="relative overflow-hidden rounded-2xl bg-gradient-to-br from-moss-700 to-moss-600 text-white shadow-soft">
            <div className="grain absolute inset-0 opacity-80" />
            <div className="relative p-4">
              <div className="flex items-start justify-between">
                <div>
                  <div className="text-xs text-white/80">{flight.airline}</div>
                  <div className="mt-1 text-lg font-semibold tracking-tight">Boarding Pass</div>
                </div>
                <div className="rounded-full bg-white/15 px-3 py-1 text-xs font-semibold ring-1 ring-white/25">
                  {isGo ? "å»ç¨‹" : "å›ç¨‹"} Â· {no}
                </div>
              </div>

              <div className="mt-4 grid grid-cols-3 items-center gap-3">
                <div>
                  <div className="text-xs text-white/70">From</div>
                  <div className="mt-1 text-base font-semibold">{from.split(" ")[0]}</div>
                  <div className="text-xs text-white/70">{from.replace(from.split(" ")[0], "").trim()}</div>
                </div>
                <div className="text-center">
                  <div className="text-2xl">âœˆï¸</div>
                  <div className="mt-1 text-xs text-white/70">Non-stop</div>
                </div>
                <div className="text-right">
                  <div className="text-xs text-white/70">To</div>
                  <div className="mt-1 text-base font-semibold">{to.split(" ")[0]}</div>
                  <div className="text-xs text-white/70">{to.replace(to.split(" ")[0], "").trim()}</div>
                </div>
              </div>

              <div className="mt-4 grid grid-cols-2 gap-3">
                <div className="rounded-2xl bg-white/12 p-3 ring-1 ring-white/20">
                  <div className="text-xs text-white/70">Depart</div>
                  <div className="mt-1 text-sm font-semibold">{depart}</div>
                </div>
                <div className="rounded-2xl bg-white/12 p-3 ring-1 ring-white/20">
                  <div className="text-xs text-white/70">Arrive</div>
                  <div className="mt-1 text-sm font-semibold">{arrive}</div>
                </div>
              </div>

              <div className="mt-4 flex items-center justify-between text-xs text-white/75">
                <div>Seat: {flight.seat}</div>
                <div>PNR: {flight.pnr}</div>
              </div>
            </div>

            <div className="relative flex items-center justify-between border-t border-white/20 px-4 py-3">
              <div className="text-xs text-white/80">Mobile</div>
              <div className="h-6 w-24 rounded-md bg-white/20 ring-1 ring-white/25" />
            </div>
          </div>
        );
      }

      function HotelCard({ hotel }) {
        return (
          <Card className="overflow-hidden">
            <div className="relative h-36">
              <img src={hotel.img} alt="hotel" className="h-full w-full object-cover" />
              <div className="absolute inset-0 bg-gradient-to-t from-black/45 to-transparent" />
              <div className="absolute left-4 bottom-3">
                <div className="text-xs text-white/80">ä½å®¿</div>
                <div className="text-lg font-semibold text-white">{hotel.name}</div>
              </div>
            </div>
            <div className="p-4">
              <div className="grid grid-cols-2 gap-3">
                <div className="rounded-2xl bg-sand-50 p-3 ring-1 ring-sand-100">
                  <div className="text-xs text-sand-500">Check-in</div>
                  <div className="mt-1 text-sm font-semibold">{hotel.checkin}</div>
                </div>
                <div className="rounded-2xl bg-sand-50 p-3 ring-1 ring-sand-100">
                  <div className="text-xs text-sand-500">Check-out</div>
                  <div className="mt-1 text-sm font-semibold">{hotel.checkout}</div>
                </div>
              </div>

              <div className="mt-3 rounded-2xl bg-white p-3 ring-1 ring-sand-100">
                <div className="text-xs text-sand-500">åœ°å€</div>
                <div className="mt-1 text-sm text-sand-800">{hotel.address}</div>
              </div>

              <div className="mt-3 flex gap-2">
                <a
                  href={hotel.map}
                  target="_blank"
                  rel="noreferrer"
                  className="flex-1 rounded-2xl bg-moss-600 px-4 py-3 text-center text-sm font-semibold text-white shadow-soft hover:bg-moss-700"
                >
                  æ‰“é–‹åœ°åœ–
                </a>
                <button
                  onClick={() => navigator.clipboard?.writeText(`${hotel.name} ${hotel.address}`)}
                  className="flex-1 rounded-2xl bg-white px-4 py-3 text-sm font-semibold shadow-soft ring-1 ring-sand-100 hover:bg-sand-50"
                >
                  è¤‡è£½åœ°å€
                </button>
              </div>

              <div className="mt-3 text-xs text-sand-500">{hotel.note}</div>
            </div>
          </Card>
        );
      }

      function BookingsTab() {
        const [bookings] = useState(INITIAL_BOOKINGS);

        return (
          <div className="mx-auto max-w-md px-4 pb-28 pt-4 space-y-4">
            <div className="flex items-center justify-between">
              <div>
                <div className="text-sm text-sand-600">æ©Ÿç¥¨</div>
                <div className="text-base font-semibold">ç™»æ©Ÿè­‰å¡ç‰‡</div>
              </div>
              <div className="text-xs text-sand-500">Prototype</div>
            </div>

            <BoardingPass flight={bookings.flight} direction="go" />
            <BoardingPass flight={bookings.flight} direction="back" />

            <div className="pt-2">
              <div className="text-sm text-sand-600">ä½å®¿</div>
              <div className="text-base font-semibold">é£¯åº—è³‡è¨Š</div>
            </div>

            <HotelCard hotel={bookings.hotel} />
          </div>
        );
      }

      // ---------- Expense Tab ----------
      const PEOPLE = ["æˆ‘", "æœ‹å‹A", "æœ‹å‹B"];

      const DEFAULT_RATE = 0.22; // 1 JPY â‰ˆ 0.22 TWD (ä¼°ç®—ç”¨ï¼›ä¹‹å¾Œå¯æ¥åŒ¯ç‡ API)

      function ExpenseTab() {
        const [rate, setRate] = useState(DEFAULT_RATE);

        const [entries, setEntries] = useState([
          {
            id: "e1",
            dateKey: "2026-01-01",
            time: "12:10",
            title: "åˆ©æœ¨æ´¥å·´å£«è»Šç¥¨",
            currency: "JPY",
            amount: 3400,
            category: "move",
            payer: "æˆ‘",
            split: ["æˆ‘", "æœ‹å‹A", "æœ‹å‹B"],
          },
          {
            id: "e2",
            dateKey: "2026-01-01",
            time: "19:10",
            title: "é—œæ±ç…®æ™šé¤",
            currency: "JPY",
            amount: 5400,
            category: "food",
            payer: "æœ‹å‹A",
            split: ["æˆ‘", "æœ‹å‹A", "æœ‹å‹B"],
          },
        ]);

        const [form, setForm] = useState({
          dateKey: TRIP_DAYS[0].key,
          time: "12:00",
          title: "",
          currency: "JPY",
          amount: "",
          category: "food",
          payer: "æˆ‘",
          split: ["æˆ‘", "æœ‹å‹A", "æœ‹å‹B"],
        });

        const totals = useMemo(() => {
          let totalJPY = 0;
          let totalTWD = 0;
          for (const e of entries) {
            if (e.currency === "JPY") {
              totalJPY += e.amount;
              totalTWD += e.amount * rate;
            } else {
              totalTWD += e.amount;
              totalJPY += e.amount / rate;
            }
          }
          return { totalJPY, totalTWD };
        }, [entries, rate]);

        const grouped = useMemo(() => {
          const m = new Map();
          for (const e of entries) {
            const k = e.dateKey;
            if (!m.has(k)) m.set(k, []);
            m.get(k).push(e);
          }
          for (const [k, arr] of m.entries()) {
            arr.sort((a, b) => (a.time || "").localeCompare(b.time || ""));
            m.set(k, arr);
          }
          return m;
        }, [entries]);

        const estimate = useMemo(() => {
          const amt = Number(form.amount || 0);
          if (!amt) return { twd: 0, jpy: 0 };
          if (form.currency === "JPY") return { twd: amt * rate, jpy: amt };
          return { twd: amt, jpy: amt / rate };
        }, [form.amount, form.currency, rate]);

        const toggleSplit = (name) => {
          setForm((f) => {
            const has = f.split.includes(name);
            const next = has ? f.split.filter((x) => x !== name) : [...f.split, name];
            return { ...f, split: next.length ? next : [name] }; // keep at least one
          });
        };

        const addEntry = () => {
          const amountNum = Number(form.amount);
          if (!amountNum || amountNum <= 0) {
            alert("è«‹è¼¸å…¥é‡‘é¡ï¼ˆ> 0ï¼‰");
            return;
          }
          if (!form.title.trim()) {
            alert("è«‹è¼¸å…¥é …ç›®åç¨±");
            return;
          }
          const id = "e" + Math.random().toString(16).slice(2);
          setEntries((prev) => [
            ...prev,
            {
              id,
              dateKey: form.dateKey,
              time: form.time,
              title: form.title.trim(),
              currency: form.currency,
              amount: amountNum,
              category: form.category,
              payer: form.payer,
              split: form.split,
            },
          ]);
          setForm((f) => ({ ...f, title: "", amount: "" }));
        };

        const removeEntry = (id) => {
          setEntries((prev) => prev.filter((e) => e.id !== id));
        };

        return (
          <div className="mx-auto max-w-md px-4 pb-28 pt-4 space-y-4">
            {/* Totals */}
            <Card className="p-4">
              <div className="flex items-start justify-between gap-3">
                <div>
                  <div className="text-sm text-sand-600">ç¸½æ”¯å‡ºå„€è¡¨æ¿</div>
                  <div className="mt-1 text-lg font-semibold">æ—…è²»ç¸½è¦½</div>
                </div>
                <div className="rounded-2xl bg-sand-50 px-3 py-2 ring-1 ring-sand-100">
                  <div className="text-[11px] text-sand-500">ä¼°ç®—åŒ¯ç‡</div>
                  <div className="mt-0.5 text-sm font-semibold">
                    1 JPY â‰ˆ{" "}
                    <input
                      value={rate}
                      onChange={(e) => setRate(Number(e.target.value) || DEFAULT_RATE)}
                      inputMode="decimal"
                      className="w-16 rounded-lg bg-white px-2 py-1 text-center ring-1 ring-sand-100"
                    />{" "}
                    TWD
                  </div>
                </div>
              </div>

              <div className="mt-4 grid grid-cols-2 gap-3">
                <div className="rounded-2xl bg-moss-600 p-4 text-white shadow-soft">
                  <div className="text-xs text-white/80">å°å¹£ï¼ˆä¼°ç®—ï¼‰</div>
                  <div className="mt-1 text-2xl font-semibold tracking-tight">NT$ {fmtMoney(totals.totalTWD)}</div>
                </div>
                <div className="rounded-2xl bg-clay-600 p-4 text-white shadow-soft">
                  <div className="text-xs text-white/80">æ—¥å¹£ï¼ˆä¼°ç®—ï¼‰</div>
                  <div className="mt-1 text-2xl font-semibold tracking-tight">Â¥ {fmtMoney(totals.totalJPY)}</div>
                </div>
              </div>
              <div className="mt-3 text-xs text-sand-500">
                è¨»ï¼šç›®å‰ç‚ºåŸå‹ï¼›ä¹‹å¾Œå¯æŠŠåŒ¯ç‡æ”¹ç‚ºè‡ªå‹•æŠ“å–ï¼ˆex: Open Exchange Rates / éŠ€è¡Œç‰Œå‘Šï¼‰ã€‚
              </div>
            </Card>

            {/* Add Expense */}
            <Card className="p-4">
              <div className="flex items-center justify-between">
                <div>
                  <div className="text-sm text-sand-600">æ–°å¢è¨˜å¸³</div>
                  <div className="text-base font-semibold">å¿«é€Ÿè¼¸å…¥</div>
                </div>
                <div className="text-xs text-sand-500">Mobile-first</div>
              </div>

              <div className="mt-3 grid grid-cols-2 gap-3">
                <div>
                  <label className="text-xs text-sand-500">æ—¥æœŸ</label>
                  <select
                    value={form.dateKey}
                    onChange={(e) => setForm((f) => ({ ...f, dateKey: e.target.value }))}
                    className="mt-1 w-full rounded-2xl bg-sand-50 px-3 py-3 text-sm ring-1 ring-sand-100"
                  >
                    {TRIP_DAYS.map((d) => (
                      <option key={d.key} value={d.key}>{d.label}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="text-xs text-sand-500">æ™‚é–“</label>
                  <input
                    type="time"
                    value={form.time}
                    onChange={(e) => setForm((f) => ({ ...f, time: e.target.value }))}
                    className="mt-1 w-full rounded-2xl bg-sand-50 px-3 py-3 text-sm ring-1 ring-sand-100"
                  />
                </div>

                <div className="col-span-2">
                  <label className="text-xs text-sand-500">é …ç›®</label>
                  <input
                    value={form.title}
                    onChange={(e) => setForm((f) => ({ ...f, title: e.target.value }))}
                    placeholder="ä¾‹å¦‚ï¼šåˆé¤ã€è»Šç¥¨ã€å’–å•¡ã€é–€ç¥¨â€¦"
                    className="mt-1 w-full rounded-2xl bg-sand-50 px-3 py-3 text-sm ring-1 ring-sand-100"
                  />
                </div>

                <div>
                  <label className="text-xs text-sand-500">å¹£åˆ¥</label>
                  <select
                    value={form.currency}
                    onChange={(e) => setForm((f) => ({ ...f, currency: e.target.value }))}
                    className="mt-1 w-full rounded-2xl bg-sand-50 px-3 py-3 text-sm ring-1 ring-sand-100"
                  >
                    <option value="JPY">JPY æ—¥å¹£</option>
                    <option value="TWD">TWD å°å¹£</option>
                  </select>
                </div>

                <div>
                  <label className="text-xs text-sand-500">é‡‘é¡</label>
                  <input
                    value={form.amount}
                    onChange={(e) => setForm((f) => ({ ...f, amount: e.target.value.replace(/[^\d.]/g, "") }))}
                    inputMode="numeric"
                    placeholder="åªèƒ½è¼¸å…¥æ•¸å­—"
                    className="mt-1 w-full rounded-2xl bg-sand-50 px-3 py-3 text-sm ring-1 ring-sand-100"
                  />
                </div>

                <div>
                  <label className="text-xs text-sand-500">é¡åˆ¥</label>
                  <select
                    value={form.category}
                    onChange={(e) => setForm((f) => ({ ...f, category: e.target.value }))}
                    className="mt-1 w-full rounded-2xl bg-sand-50 px-3 py-3 text-sm ring-1 ring-sand-100"
                  >
                    <option value="food">ç¾é£Ÿ</option>
                    <option value="sight">æ™¯é»</option>
                    <option value="move">äº¤é€š</option>
                    <option value="stay">ä½å®¿</option>
                  </select>
                </div>

                <div>
                  <label className="text-xs text-sand-500">ä»˜æ¬¾äºº</label>
                  <select
                    value={form.payer}
                    onChange={(e) => setForm((f) => ({ ...f, payer: e.target.value }))}
                    className="mt-1 w-full rounded-2xl bg-sand-50 px-3 py-3 text-sm ring-1 ring-sand-100"
                  >
                    {PEOPLE.map((p) => (
                      <option key={p} value={p}>{p}</option>
                    ))}
                  </select>
                </div>

                <div className="col-span-2">
                  <div className="flex items-center justify-between">
                    <label className="text-xs text-sand-500">åˆ†æ”¤å°è±¡</label>
                    <div className="text-xs text-sand-500">
                      ä¼°ç®—ï¼šNT$ {fmtMoney(estimate.twd)} / Â¥ {fmtMoney(estimate.jpy)}
                    </div>
                  </div>
                  <div className="mt-2 flex flex-wrap gap-2">
                    {PEOPLE.map((p) => {
                      const active = form.split.includes(p);
                      return (
                        <button
                          key={p}
                          onClick={() => toggleSplit(p)}
                          className={cx(
                            "rounded-full px-3 py-2 text-sm font-medium ring-1 transition",
                            active ? "bg-moss-600 text-white ring-moss-600" : "bg-white text-sand-800 ring-sand-100 hover:bg-sand-50"
                          )}
                        >
                          {active ? "âœ“ " : ""}{p}
                        </button>
                      );
                    })}
                  </div>
                </div>

                <div className="col-span-2">
                  <button
                    onClick={addEntry}
                    className="w-full rounded-2xl bg-moss-600 px-4 py-3 text-sm font-semibold text-white shadow-soft hover:bg-moss-700"
                  >
                    æ–°å¢åˆ°åˆ—è¡¨
                  </button>
                </div>
              </div>
            </Card>

            {/* List */}
            <div className="flex items-center justify-between">
              <div>
                <div className="text-sm text-sand-600">æ¯æ—¥æ”¯å‡ºæ˜ç´°</div>
                <div className="text-base font-semibold">åˆ—è¡¨</div>
              </div>
              <div className="text-xs text-sand-500">{entries.length} ç­†</div>
            </div>

            {[...grouped.keys()].sort().map((dayKey) => {
              const day = TRIP_DAYS.find((d) => d.key === dayKey)?.label ?? dayKey;
              const arr = grouped.get(dayKey);
              const dayTotalTWD = arr.reduce((sum, e) => sum + (e.currency === "TWD" ? e.amount : e.amount * rate), 0);
              return (
                <Card key={dayKey} className="p-4">
                  <div className="flex items-center justify-between">
                    <div className="text-sm font-semibold">{day}</div>
                    <div className="text-xs text-sand-600">å°è¨ˆ NT$ {fmtMoney(dayTotalTWD)}</div>
                  </div>

                  <div className="mt-3 space-y-2">
                    {arr.map((e) => {
                      const meta = CATEGORY[e.category] ?? CATEGORY.sight;
                      const twd = e.currency === "TWD" ? e.amount : e.amount * rate;
                      return (
                        <div key={e.id} className="rounded-2xl bg-sand-50 ring-1 ring-sand-100 px-3 py-3">
                          <div className="flex items-start justify-between gap-3">
                            <div className="min-w-0">
                              <div className="flex items-center gap-2">
                                <span className={cx("rounded-full px-2 py-1 text-[11px] font-semibold", meta.pill)}>
                                  {meta.label}
                                </span>
                                <span className="text-xs text-sand-500">{e.time}</span>
                              </div>
                              <div className="mt-1 text-sm font-semibold truncate">{e.title}</div>
                              <div className="mt-1 text-xs text-sand-600">
                                ä»˜æ¬¾äººï¼š<span className="font-medium">{e.payer}</span> Â· åˆ†æ”¤ï¼š{e.split.join("ã€")}
                              </div>
                            </div>

                            <div className="shrink-0 text-right">
                              <div className="text-sm font-semibold">
                                {e.currency === "JPY" ? `Â¥ ${fmtMoney(e.amount)}` : `NT$ ${fmtMoney(e.amount)}`}
                              </div>
                              <div className="text-xs text-sand-500">â‰ˆ NT$ {fmtMoney(twd)}</div>
                              <button
                                onClick={() => removeEntry(e.id)}
                                className="mt-2 rounded-full bg-white px-3 py-1 text-xs font-semibold ring-1 ring-sand-100 hover:bg-sand-100"
                              >
                                åˆªé™¤
                              </button>
                            </div>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </Card>
              );
            })}
          </div>
        );
      }

      // ---------- App Shell ----------
      function App() {
        const [tab, setTab] = useState("schedule");

        const header = useMemo(() => {
          if (tab === "schedule") return { title: "è¡Œç¨‹", subtitle: "é‡‘æ¾¤ãƒ»å¯Œå±±ãƒ»é«˜å±±" };
          if (tab === "bookings") return { title: "é è¨‚", subtitle: "æ©Ÿç¥¨ãƒ»ä½å®¿" };
          return { title: "è¨˜å¸³", subtitle: "åœ˜é«”åˆ†æ”¤" };
        }, [tab]);

        return (
          <div className="min-h-screen">
            <TopBar title={header.title} subtitle={header.subtitle} />

            {tab === "schedule" && <ScheduleTab />}
            {tab === "bookings" && <BookingsTab />}
            {tab === "expense" && <ExpenseTab />}

            <TabBar tab={tab} setTab={setTab} />
          </div>
        );
      }

      // Render
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);

      // Optional: Service Worker registration placeholder (for later PWA upgrade)
      // Note: In this single-file prototype (CDN), a real offline SW/manifest needs separate files or a build step.
      // if ("serviceWorker" in navigator) navigator.serviceWorker.register("/sw.js");
    </script>
  </body>
</html>
